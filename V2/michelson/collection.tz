{ parameter
    (or (or (pair %addCollection
               (or %nft_deployment (address %existing) (unit %new))
               (list %tokens_to_mint (pair (string %metadata_url) (nat %editions)))
               (nat %royalties))
            (pair %internalUpdateNftProxy
               (or %update_proxy_param (address %add_proxy) (address %remove_proxy))
               (address %nft_address)))
        (address %updateMultisig)) ;
  storage
    (pair (nat %next_collection_id)
          (address %royalties)
          (big_map %collections nat (pair (address %nft) (address %crowdsale)))
          (address %multisig)) ;
  code { LAMBDA
           (pair address
                 nat
                 nat
                 nat
                 (big_map address nat)
                 nat
                 (big_map address nat)
                 nat
                 bool
                 nat
                 nat
                 timestamp
                 timestamp
                 nat
                 address
                 (list string)
                 bool
                 (map string bytes)
                 (or (or address (pair address nat)) unit)
                 nat)
           (pair operation address)
           { PUSH mutez 0 ;
             NONE key_hash ;
             PAIR ;
             PAIR ;
             UNPPAIIR ;
             CREATE_CONTRACT
               { parameter
                   (or (or (or (list %addToWhitelist (pair (address %user_address) (nat %tokens_to_mint)))
                               (address %collect))
                           (or (pair %mintFromCrowdsale (nat %tokens) (address %owner) (nat %amount_to_pay))
                               (list %removeFromWhitelist address)))
                       (or (or (bool %setPause)
                               (pair %setSale
                                  (bool %is_presale)
                                  (list %metadata_list string)
                                  (nat %price_per_token)
                                  (nat %max_mint_per_user)
                                  (nat %sale_size)
                                  (timestamp %start_time)
                                  (timestamp %end_time)
                                  (or %sale_currency (or (address %fa12) (pair %fa2 address nat)) (unit %xtz))))
                           (or (bytes %updateContractMetadata)
                               (pair %updateTokenMetadata (list %tokens nat) (list %metadata_urls string))))) ;
                 storage
                   (pair (address %multisig)
                         (nat %max_mint_per_transaction)
                         (nat %max_mint_per_user)
                         (nat %tokens_sold)
                         (big_map %whitelist address nat)
                         (nat %next_token_id)
                         (big_map %minted_per_user address nat)
                         (nat %price_per_token)
                         (bool %is_presale)
                         (nat %number_of_users_in_sale)
                         (nat %total_to_mint)
                         (timestamp %start_time)
                         (timestamp %end_time)
                         (nat %sale_size)
                         (address %collection)
                         (list %available_metadata string)
                         (bool %paused)
                         (map %default_metadata string bytes)
                         (or %sale_currency (or (address %fa12) (pair %fa2 address nat)) (unit %xtz))
                         (nat %earnings)) ;
                 code { LAMBDA
                          (pair (option operation) (list operation))
                          (list operation)
                          { UNPAIR ; IF_NONE {} { CONS } } ;
                        SWAP ;
                        UNPAIR ;
                        IF_LEFT
                          { IF_LEFT
                              { IF_LEFT
                                  { DIG 2 ;
                                    DROP ;
                                    DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "addToWhitelist" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address (list (pair address nat))) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %addToWhitelist (list (pair (address %user_address) (nat %tokens_to_mint))) ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no addToWhitelist entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } ;
                                         PAIR }
                                       { DUP 2 ;
                                         GET 17 ;
                                         NOT ;
                                         IF { DROP 2 ; PUSH nat 406 ; FAILWITH }
                                            { DUP 2 ;
                                              GET 27 ;
                                              DUP 2 ;
                                              SIZE ;
                                              DUP 4 ;
                                              GET 19 ;
                                              ADD ;
                                              COMPARE ;
                                              GT ;
                                              IF { DROP 2 ; PUSH nat 404 ; FAILWITH }
                                                 { DUP 2 ;
                                                   DUP 2 ;
                                                   ITER { SWAP ;
                                                          DUP ;
                                                          GET 9 ;
                                                          DUP 3 ;
                                                          CAR ;
                                                          GET ;
                                                          IF_NONE
                                                            { DUP ;
                                                              GET 5 ;
                                                              DUP 3 ;
                                                              CDR ;
                                                              COMPARE ;
                                                              GT ;
                                                              IF { SWAP ; DROP ; PUSH nat 405 ; FAILWITH }
                                                                 { DUP ; GET 9 ; DUP 3 ; CDR ; SOME ; DIG 3 ; CAR ; UPDATE } }
                                                            { DUP 2 ;
                                                              GET 5 ;
                                                              DUP 2 ;
                                                              DUP 5 ;
                                                              CDR ;
                                                              ADD ;
                                                              COMPARE ;
                                                              GT ;
                                                              IF { DIG 2 ; DROP 2 ; PUSH nat 405 ; FAILWITH }
                                                                 { DUP 2 ;
                                                                   GET 9 ;
                                                                   SWAP ;
                                                                   DUP 4 ;
                                                                   CDR ;
                                                                   ADD ;
                                                                   SOME ;
                                                                   DIG 3 ;
                                                                   CAR ;
                                                                   PAIR 3 ;
                                                                   UNPAIR 3 ;
                                                                   UPDATE } } ;
                                                          UPDATE 9 } ;
                                                   SWAP ;
                                                   SIZE ;
                                                   DIG 2 ;
                                                   GET 19 ;
                                                   ADD ;
                                                   UPDATE 19 ;
                                                   NIL operation ;
                                                   PAIR } } } }
                                  { DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { DIG 2 ;
                                         DROP ;
                                         SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "collect" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address address) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %collect address ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no collect entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } }
                                       { NIL operation ;
                                         DUP 3 ;
                                         GET 38 ;
                                         DIG 2 ;
                                         SELF_ADDRESS ;
                                         DUP 5 ;
                                         GET 37 ;
                                         PAIR 4 ;
                                         UNPAIR 4 ;
                                         PUSH nat 0 ;
                                         DUP 5 ;
                                         COMPARE ;
                                         EQ ;
                                         IF { DROP 4 ; NONE operation }
                                            { IF_LEFT
                                                { IF_LEFT
                                                    { CONTRACT %transfer (pair (address %from) (address %to) (nat %value)) ;
                                                      IF_NONE { PUSH nat 421 ; FAILWITH } {} ;
                                                      PUSH mutez 0 ;
                                                      DIG 4 ;
                                                      DIG 4 ;
                                                      DIG 4 ;
                                                      PAIR 3 ;
                                                      PAIR 3 ;
                                                      UNPAIR 3 ;
                                                      TRANSFER_TOKENS }
                                                    { UNPAIR ;
                                                      CONTRACT %transfer
                                                        (list (pair (address %from_) (list %txs (pair (address %to_) (nat %token_id) (nat %amount))))) ;
                                                      IF_NONE { PUSH nat 422 ; FAILWITH } {} ;
                                                      PUSH mutez 0 ;
                                                      NIL (pair address (list (pair address nat nat))) ;
                                                      NIL (pair address nat nat) ;
                                                      DIG 7 ;
                                                      DIG 5 ;
                                                      DIG 7 ;
                                                      PAIR 3 ;
                                                      CONS ;
                                                      DIG 4 ;
                                                      PAIR ;
                                                      CONS ;
                                                      PAIR 3 ;
                                                      UNPAIR 3 ;
                                                      TRANSFER_TOKENS } ;
                                                  SOME }
                                                { DROP 2 ;
                                                  SELF_ADDRESS ;
                                                  DUP 2 ;
                                                  COMPARE ;
                                                  EQ ;
                                                  IF { DROP 2 ; NONE operation }
                                                     { CONTRACT unit ;
                                                       IF_NONE { PUSH nat 423 ; FAILWITH } {} ;
                                                       PUSH mutez 1 ;
                                                       DIG 2 ;
                                                       MUL ;
                                                       UNIT ;
                                                       PAIR 3 ;
                                                       UNPAIR 3 ;
                                                       TRANSFER_TOKENS ;
                                                       SOME } } } ;
                                         PAIR ;
                                         DIG 2 ;
                                         SWAP ;
                                         EXEC ;
                                         SWAP ;
                                         PUSH nat 0 ;
                                         UPDATE 38 ;
                                         SWAP } ;
                                    PAIR } }
                              { IF_LEFT
                                  { UNPAIR 3 ;
                                    PUSH nat 0 ;
                                    DUP 2 ;
                                    COMPARE ;
                                    EQ ;
                                    IF { DROP 5 ; PUSH nat 416 ; FAILWITH }
                                       { DUP 4 ;
                                         GET 25 ;
                                         NOW ;
                                         COMPARE ;
                                         GE ;
                                         DUP 5 ;
                                         GET 23 ;
                                         NOW ;
                                         COMPARE ;
                                         LT ;
                                         OR ;
                                         IF { DROP 5 ; PUSH nat 415 ; FAILWITH }
                                            { DUP 4 ;
                                              GET 17 ;
                                              IF { DUP 4 ;
                                                   GET 9 ;
                                                   DUP 3 ;
                                                   GET ;
                                                   IF_NONE
                                                     { PUSH nat 412 ; FAILWITH }
                                                     { DUP ;
                                                       DUP 3 ;
                                                       COMPARE ;
                                                       GT ;
                                                       IF { DROP ; PUSH nat 411 ; FAILWITH }
                                                          { DUP 2 ; SWAP ; SUB ; ABS ; DUP 2 ; PAIR } } }
                                                 { PUSH nat 0 ; DUP 2 ; PAIR } ;
                                              UNPAIR ;
                                              DUP 6 ;
                                              GET 13 ;
                                              DUP 5 ;
                                              GET ;
                                              IF_NONE { PUSH nat 0 } {} ;
                                              DUP 7 ;
                                              GET 5 ;
                                              DUP 3 ;
                                              DUP 3 ;
                                              ADD ;
                                              COMPARE ;
                                              GT ;
                                              IF { DROP ; PUSH nat 425 ; FAILWITH } { DUP 2 ; ADD } ;
                                              AMOUNT ;
                                              PUSH mutez 1 ;
                                              SWAP ;
                                              EDIV ;
                                              IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                              CAR ;
                                              DUP 7 ;
                                              COMPARE ;
                                              NEQ ;
                                              UNIT ;
                                              RIGHT (or address (pair address nat)) ;
                                              DUP 9 ;
                                              GET 37 ;
                                              COMPARE ;
                                              EQ ;
                                              AND ;
                                              IF { DIG 5 ; DROP ; PUSH nat 424 ; FAILWITH }
                                                 { PUSH mutez 0 ;
                                                   AMOUNT ;
                                                   COMPARE ;
                                                   NEQ ;
                                                   UNIT ;
                                                   RIGHT (or address (pair address nat)) ;
                                                   DUP 9 ;
                                                   GET 37 ;
                                                   COMPARE ;
                                                   NEQ ;
                                                   AND ;
                                                   IF { DIG 5 ; DROP ; PUSH nat 426 ; FAILWITH } { DIG 5 } } ;
                                              DUP ;
                                              DUP 8 ;
                                              GET 15 ;
                                              DUP 7 ;
                                              MUL ;
                                              COMPARE ;
                                              GT ;
                                              IF { DROP 8 ; PUSH nat 414 ; FAILWITH }
                                                 { DUP 7 ;
                                                   GET 21 ;
                                                   DIG 5 ;
                                                   DUP 8 ;
                                                   GET 11 ;
                                                   ADD ;
                                                   COMPARE ;
                                                   GT ;
                                                   IF { DROP 7 ; PUSH nat 413 ; FAILWITH }
                                                      { DUP ;
                                                        SELF_ADDRESS ;
                                                        SENDER ;
                                                        DUP 9 ;
                                                        GET 37 ;
                                                        PAIR 4 ;
                                                        UNPAIR 4 ;
                                                        PUSH nat 0 ;
                                                        DUP 5 ;
                                                        COMPARE ;
                                                        EQ ;
                                                        IF { DROP 4 ; NONE operation }
                                                           { IF_LEFT
                                                               { IF_LEFT
                                                                   { CONTRACT %transfer (pair (address %from) (address %to) (nat %value)) ;
                                                                     IF_NONE { PUSH nat 421 ; FAILWITH } {} ;
                                                                     PUSH mutez 0 ;
                                                                     DIG 4 ;
                                                                     DIG 4 ;
                                                                     DIG 4 ;
                                                                     PAIR 3 ;
                                                                     PAIR 3 ;
                                                                     UNPAIR 3 ;
                                                                     TRANSFER_TOKENS }
                                                                   { UNPAIR ;
                                                                     CONTRACT %transfer
                                                                       (list (pair (address %from_) (list %txs (pair (address %to_) (nat %token_id) (nat %amount))))) ;
                                                                     IF_NONE { PUSH nat 422 ; FAILWITH } {} ;
                                                                     PUSH mutez 0 ;
                                                                     NIL (pair address (list (pair address nat nat))) ;
                                                                     NIL (pair address nat nat) ;
                                                                     DIG 7 ;
                                                                     DIG 5 ;
                                                                     DIG 7 ;
                                                                     PAIR 3 ;
                                                                     CONS ;
                                                                     DIG 4 ;
                                                                     PAIR ;
                                                                     CONS ;
                                                                     PAIR 3 ;
                                                                     UNPAIR 3 ;
                                                                     TRANSFER_TOKENS } ;
                                                                 SOME }
                                                               { DROP 2 ;
                                                                 SELF_ADDRESS ;
                                                                 DUP 2 ;
                                                                 COMPARE ;
                                                                 EQ ;
                                                                 IF { DROP 2 ; NONE operation }
                                                                    { CONTRACT unit ;
                                                                      IF_NONE { PUSH nat 423 ; FAILWITH } {} ;
                                                                      PUSH mutez 1 ;
                                                                      DIG 2 ;
                                                                      MUL ;
                                                                      UNIT ;
                                                                      PAIR 3 ;
                                                                      UNPAIR 3 ;
                                                                      TRANSFER_TOKENS ;
                                                                      SOME } } } ;
                                                        DUP 7 ;
                                                        NIL operation ;
                                                        DUP 8 ;
                                                        DIG 6 ;
                                                        PAIR 4 ;
                                                        LEFT (pair (list operation)
                                                                   address
                                                                   nat
                                                                   nat
                                                                   nat
                                                                   (big_map address nat)
                                                                   nat
                                                                   (big_map address nat)
                                                                   nat
                                                                   bool
                                                                   nat
                                                                   nat
                                                                   timestamp
                                                                   timestamp
                                                                   nat
                                                                   address
                                                                   (list string)
                                                                   bool
                                                                   (map string bytes)
                                                                   (or (or address (pair address nat)) unit)
                                                                   nat) ;
                                                        LOOP_LEFT
                                                          { UNPAIR 4 ;
                                                            PUSH nat 0 ;
                                                            DUP 2 ;
                                                            COMPARE ;
                                                            EQ ;
                                                            IF { DROP 2 ;
                                                                 PAIR ;
                                                                 RIGHT
                                                                   (pair nat
                                                                         address
                                                                         (list operation)
                                                                         (pair address
                                                                               nat
                                                                               nat
                                                                               nat
                                                                               (big_map address nat)
                                                                               nat
                                                                               (big_map address nat)
                                                                               nat
                                                                               bool
                                                                               nat
                                                                               nat
                                                                               timestamp
                                                                               timestamp
                                                                               nat
                                                                               address
                                                                               (list string)
                                                                               bool
                                                                               (map string bytes)
                                                                               (or (or address (pair address nat)) unit)
                                                                               nat)) }
                                                               { DUP 4 ;
                                                                 GET 31 ;
                                                                 IF_CONS { SWAP ; DROP ; SOME } { NONE string } ;
                                                                 IF_NONE
                                                                   { DUP 4 ; GET 35 }
                                                                   { EMPTY_MAP string bytes ; SWAP ; PACK ; SOME ; PUSH string "" ; UPDATE } ;
                                                                 DUP 5 ;
                                                                 GET 29 ;
                                                                 CONTRACT %mint
                                                                   (pair (nat %token_id)
                                                                         (map %token_metadata string bytes)
                                                                         (nat %amount_)
                                                                         (address %owner)) ;
                                                                 IF_NONE { PUSH nat 409 ; FAILWITH } {} ;
                                                                 DIG 4 ;
                                                                 SWAP ;
                                                                 PUSH mutez 0 ;
                                                                 DUP 6 ;
                                                                 PUSH nat 1 ;
                                                                 DIG 5 ;
                                                                 DUP 9 ;
                                                                 GET 11 ;
                                                                 PAIR 4 ;
                                                                 TRANSFER_TOKENS ;
                                                                 CONS ;
                                                                 PUSH nat 1 ;
                                                                 DIG 2 ;
                                                                 SUB ;
                                                                 ABS ;
                                                                 PUSH nat 1 ;
                                                                 DUP 5 ;
                                                                 GET 11 ;
                                                                 ADD ;
                                                                 DUP 5 ;
                                                                 SWAP ;
                                                                 UPDATE 11 ;
                                                                 DIG 4 ;
                                                                 GET 31 ;
                                                                 IF_CONS { DROP ; SOME } { NONE (list string) } ;
                                                                 IF_NONE { NIL string } {} ;
                                                                 UPDATE 31 ;
                                                                 DIG 2 ;
                                                                 DIG 3 ;
                                                                 DIG 3 ;
                                                                 PAIR 4 ;
                                                                 LEFT (pair (list operation)
                                                                            address
                                                                            nat
                                                                            nat
                                                                            nat
                                                                            (big_map address nat)
                                                                            nat
                                                                            (big_map address nat)
                                                                            nat
                                                                            bool
                                                                            nat
                                                                            nat
                                                                            timestamp
                                                                            timestamp
                                                                            nat
                                                                            address
                                                                            (list string)
                                                                            bool
                                                                            (map string bytes)
                                                                            (or (or address (pair address nat)) unit)
                                                                            nat) } } ;
                                                        UNPAIR ;
                                                        DIG 2 ;
                                                        PAIR ;
                                                        DIG 7 ;
                                                        SWAP ;
                                                        EXEC ;
                                                        DUP 2 ;
                                                        GET 17 ;
                                                        IF { DUP 2 ; DIG 2 ; GET 9 ; DIG 5 ; SOME ; DUP 7 ; UPDATE ; UPDATE 9 }
                                                           { DIG 4 ; DROP ; SWAP } ;
                                                        DUP ;
                                                        DIG 3 ;
                                                        DIG 2 ;
                                                        GET 38 ;
                                                        ADD ;
                                                        UPDATE 38 ;
                                                        DIG 4 ;
                                                        GET 13 ;
                                                        DIG 3 ;
                                                        SOME ;
                                                        DIG 4 ;
                                                        UPDATE ;
                                                        UPDATE 13 ;
                                                        SWAP ;
                                                        PAIR } } } } }
                                  { DIG 2 ;
                                    DROP ;
                                    DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "removeFromWhitelist" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address (list address)) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %removeFromWhitelist (list address) ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no removeFromWhitelist entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } ;
                                         PAIR }
                                       { DUP 2 ;
                                         GET 17 ;
                                         NOT ;
                                         IF { DROP 2 ; PUSH nat 406 ; FAILWITH }
                                            { ITER { SWAP ; DUP ; GET 9 ; NONE nat ; DIG 3 ; UPDATE ; UPDATE 9 } ;
                                              NIL operation ;
                                              PAIR } } } } }
                          { DIG 2 ;
                            DROP ;
                            IF_LEFT
                              { IF_LEFT
                                  { DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "setPause" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address bool) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %setPause bool ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no setPause entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } }
                                       { UPDATE 33 ; NIL operation } }
                                  { DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "setSale" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address
                                                           (pair bool
                                                                 (list string)
                                                                 nat
                                                                 nat
                                                                 nat
                                                                 timestamp
                                                                 timestamp
                                                                 (or (or address (pair address nat)) unit)))
                                                     unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %setSale
                                                   (pair (bool %is_presale)
                                                         (list %metadata_list string)
                                                         (nat %price_per_token)
                                                         (nat %max_mint_per_user)
                                                         (nat %sale_size)
                                                         (timestamp %start_time)
                                                         (timestamp %end_time)
                                                         (or %sale_currency (or (address %fa12) (pair %fa2 address nat)) (unit %xtz))) ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no setSale entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } }
                                       { DUP 2 ;
                                         GET 31 ;
                                         DUP 2 ;
                                         GET 3 ;
                                         ITER { CONS } ;
                                         DUP 3 ;
                                         DUP 3 ;
                                         GET 14 ;
                                         UPDATE 37 ;
                                         DUP 3 ;
                                         CAR ;
                                         UPDATE 17 ;
                                         DUP 3 ;
                                         GET 5 ;
                                         UPDATE 15 ;
                                         DUP 3 ;
                                         GET 7 ;
                                         UPDATE 5 ;
                                         DUP 3 ;
                                         GET 9 ;
                                         UPDATE 27 ;
                                         DUP 3 ;
                                         GET 11 ;
                                         UPDATE 23 ;
                                         DUP 3 ;
                                         GET 13 ;
                                         UPDATE 25 ;
                                         SWAP ;
                                         UPDATE 31 ;
                                         SWAP ;
                                         GET 9 ;
                                         DIG 2 ;
                                         GET 21 ;
                                         ADD ;
                                         UPDATE 21 ;
                                         NIL operation } } ;
                                PAIR }
                              { IF_LEFT
                                  { DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "updateContractMetadata" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address bytes) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %updateContractMetadata bytes ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no updateContractMetadata entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } }
                                       { NIL operation ;
                                         DUP 3 ;
                                         GET 29 ;
                                         CONTRACT %updateContractMetadata bytes ;
                                         IF_NONE { PUSH nat 427 ; FAILWITH } {} ;
                                         PUSH mutez 0 ;
                                         DIG 3 ;
                                         PAIR 3 ;
                                         UNPAIR 3 ;
                                         TRANSFER_TOKENS ;
                                         CONS } ;
                                    PAIR }
                                  { DUP 2 ;
                                    CAR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF { SELF_ADDRESS ;
                                         DUP 3 ;
                                         DIG 3 ;
                                         CAR ;
                                         CONTRACT %callMultisig
                                           (pair (pair %entrypoint_signature
                                                    (pair (string %name) (bytes %params))
                                                    (address %source_contract))
                                                 (lambda %callback unit (list operation))) ;
                                         IF_NONE
                                           { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                           { DUP 4 ;
                                             PACK ;
                                             SHA256 ;
                                             SELF_ADDRESS ;
                                             SWAP ;
                                             PUSH string "updateTokenMetadata" ;
                                             PAIR ;
                                             PAIR ;
                                             SWAP ;
                                             PUSH mutez 0 ;
                                             LAMBDA
                                               (pair (pair address (pair (list nat) (list string))) unit)
                                               (list operation)
                                               { UNPAIR ;
                                                 UNPAIR ;
                                                 DIG 2 ;
                                                 DROP ;
                                                 CONTRACT %updateTokenMetadata
                                                   (pair (list %tokens nat) (list %metadata_urls string)) ;
                                                 IF_NONE
                                                   { DROP ; PUSH string "no updateTokenMetadata entrypoint" ; FAILWITH }
                                                   { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                             DUP 7 ;
                                             DUP 7 ;
                                             PAIR ;
                                             APPLY ;
                                             DIG 5 ;
                                             DIG 6 ;
                                             DROP 2 ;
                                             DIG 3 ;
                                             PAIR ;
                                             TRANSFER_TOKENS ;
                                             NIL operation ;
                                             SWAP ;
                                             CONS } ;
                                         PAIR }
                                       { PUSH nat 0 ;
                                         DUP 2 ;
                                         CAR ;
                                         SIZE ;
                                         COMPARE ;
                                         EQ ;
                                         IF { DROP 2 ; PUSH nat 420 ; FAILWITH }
                                            { DUP ;
                                              CDR ;
                                              SIZE ;
                                              DUP 2 ;
                                              CAR ;
                                              SIZE ;
                                              COMPARE ;
                                              NEQ ;
                                              IF { DROP 2 ; PUSH nat 419 ; FAILWITH }
                                                 { DUP 2 ;
                                                   DIG 2 ;
                                                   NIL operation ;
                                                   DUP 4 ;
                                                   CDR ;
                                                   DIG 4 ;
                                                   CAR ;
                                                   PAIR 4 ;
                                                   LEFT (list operation) ;
                                                   LOOP_LEFT
                                                     { UNPAIR 4 ;
                                                       PUSH nat 0 ;
                                                       DUP 2 ;
                                                       SIZE ;
                                                       COMPARE ;
                                                       EQ ;
                                                       IF { SWAP ;
                                                            DIG 3 ;
                                                            DROP 3 ;
                                                            RIGHT
                                                              (pair (list nat)
                                                                    (list string)
                                                                    (list operation)
                                                                    (pair address
                                                                          nat
                                                                          nat
                                                                          nat
                                                                          (big_map address nat)
                                                                          nat
                                                                          (big_map address nat)
                                                                          nat
                                                                          bool
                                                                          nat
                                                                          nat
                                                                          timestamp
                                                                          timestamp
                                                                          nat
                                                                          address
                                                                          (list string)
                                                                          bool
                                                                          (map string bytes)
                                                                          (or (or address (pair address nat)) unit)
                                                                          nat)) }
                                                          { DUP 2 ;
                                                            IF_CONS { SWAP ; DROP ; SOME } { NONE string } ;
                                                            IF_NONE { PUSH nat 410 ; FAILWITH } {} ;
                                                            DUP 2 ;
                                                            IF_CONS { SWAP ; DROP ; SOME } { NONE nat } ;
                                                            IF_NONE { PUSH nat 417 ; FAILWITH } {} ;
                                                            DUP 6 ;
                                                            GET 29 ;
                                                            CONTRACT %updateMetadata (pair (nat %token_id) (map %token_info string bytes)) ;
                                                            IF_NONE { PUSH nat 418 ; FAILWITH } {} ;
                                                            DIG 2 ;
                                                            PACK ;
                                                            PUSH nat 6 ;
                                                            DUP 2 ;
                                                            SIZE ;
                                                            SUB ;
                                                            ABS ;
                                                            PUSH nat 6 ;
                                                            SLICE ;
                                                            IF_NONE { PUSH string "SLICE" ; FAILWITH } {} ;
                                                            DIG 5 ;
                                                            DIG 2 ;
                                                            PUSH mutez 0 ;
                                                            EMPTY_MAP string bytes ;
                                                            DIG 4 ;
                                                            SOME ;
                                                            PUSH string "" ;
                                                            UPDATE ;
                                                            DIG 4 ;
                                                            PAIR ;
                                                            TRANSFER_TOKENS ;
                                                            CONS ;
                                                            DIG 3 ;
                                                            SWAP ;
                                                            DIG 3 ;
                                                            IF_CONS { DROP ; SOME } { NONE (list string) } ;
                                                            IF_NONE { NIL string } {} ;
                                                            DIG 3 ;
                                                            IF_CONS { DROP ; SOME } { NONE (list nat) } ;
                                                            IF_NONE { NIL nat } {} ;
                                                            PAIR 4 ;
                                                            LEFT (list operation) } } ;
                                                   PAIR } } } } } } } } ;
             PAIR } ;
         SWAP ;
         UNPAIR ;
         IF_LEFT
           { IF_LEFT
               { DUP 2 ;
                 GET 6 ;
                 SENDER ;
                 COMPARE ;
                 NEQ ;
                 IF { DIG 2 ;
                      DROP ;
                      SELF_ADDRESS ;
                      DUP 3 ;
                      DIG 3 ;
                      GET 6 ;
                      CONTRACT %callMultisig
                        (pair (pair %entrypoint_signature
                                 (pair (string %name) (bytes %params))
                                 (address %source_contract))
                              (lambda %callback unit (list operation))) ;
                      IF_NONE
                        { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                        { DUP 4 ;
                          PACK ;
                          SHA256 ;
                          SELF_ADDRESS ;
                          SWAP ;
                          PUSH string "addCollection" ;
                          PAIR ;
                          PAIR ;
                          SWAP ;
                          PUSH mutez 0 ;
                          LAMBDA
                            (pair (pair address (pair (or address unit) (list (pair string nat)) nat)) unit)
                            (list operation)
                            { UNPAIR ;
                              UNPAIR ;
                              DIG 2 ;
                              DROP ;
                              CONTRACT %addCollection
                                (pair (or %nft_deployment (address %existing) (unit %new))
                                      (list %tokens_to_mint (pair (string %metadata_url) (nat %editions)))
                                      (nat %royalties)) ;
                              IF_NONE
                                { DROP ; PUSH string "no addCollection entrypoint" ; FAILWITH }
                                { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                          DUP 7 ;
                          DUP 7 ;
                          PAIR ;
                          APPLY ;
                          DIG 5 ;
                          DIG 6 ;
                          DROP 2 ;
                          DIG 3 ;
                          PAIR ;
                          TRANSFER_TOKENS ;
                          NIL operation ;
                          SWAP ;
                          CONS } }
                    { UNPAIR 3 ;
                      IF_LEFT
                        { SWAP ;
                          DIG 2 ;
                          DROP 2 ;
                          PUSH nat 0 ;
                          UNIT ;
                          RIGHT (or address (pair address nat)) ;
                          EMPTY_MAP string bytes ;
                          PUSH bool False ;
                          NIL string ;
                          DUP 6 ;
                          PUSH nat 0 ;
                          NOW ;
                          NOW ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          PUSH bool False ;
                          PUSH nat 0 ;
                          EMPTY_BIG_MAP address nat ;
                          PUSH nat 0 ;
                          EMPTY_BIG_MAP address nat ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          DUP 21 ;
                          GET 6 ;
                          PAIR 20 ;
                          DIG 3 ;
                          SWAP ;
                          EXEC ;
                          UNPAIR ;
                          SELF_ADDRESS ;
                          CONTRACT %internalUpdateNftProxy
                            (pair (or %update_proxy_param (address %add_proxy) (address %remove_proxy))
                                  (address %nft_address)) ;
                          IF_NONE { PUSH string "option is None" ; FAILWITH } {} ;
                          PUSH mutez 0 ;
                          DUP 5 ;
                          DUP 5 ;
                          LEFT address ;
                          PAIR ;
                          TRANSFER_TOKENS ;
                          DUP 5 ;
                          CAR ;
                          DUP 6 ;
                          DIG 6 ;
                          GET 5 ;
                          DIG 5 ;
                          DIG 6 ;
                          PAIR ;
                          SOME ;
                          DUP 4 ;
                          UPDATE ;
                          UPDATE 5 ;
                          PUSH nat 1 ;
                          DIG 2 ;
                          ADD ;
                          UPDATE 1 ;
                          NIL operation }
                        { DROP ;
                          DUP ;
                          SIZE ;
                          EMPTY_BIG_MAP (pair address nat) nat ;
                          PUSH nat 0 ;
                          DUP 3 ;
                          COMPARE ;
                          EQ ;
                          IF { DIG 2 ; DROP ; EMPTY_BIG_MAP nat (pair nat (map string bytes)) ; PAIR }
                             { DUP 2 ;
                               PUSH nat 0 ;
                               DIG 2 ;
                               EMPTY_BIG_MAP nat (pair nat (map string bytes)) ;
                               DIG 5 ;
                               PAIR 5 ;
                               UNPAIR 5 ;
                               PAIR 5 ;
                               LEFT (pair (big_map nat (pair nat (map string bytes))) (big_map (pair address nat) nat)) ;
                               LOOP_LEFT
                                 { UNPAIR 5 ;
                                   DUP 5 ;
                                   DUP 5 ;
                                   COMPARE ;
                                   EQ ;
                                   IF { DIG 3 ;
                                        DIG 4 ;
                                        DROP 3 ;
                                        PAIR ;
                                        RIGHT
                                          (pair (list (pair string nat))
                                                (big_map nat (pair nat (map string bytes)))
                                                (big_map (pair address nat) nat)
                                                nat
                                                nat) }
                                      { DUP ;
                                        IF_CONS { SWAP ; DROP ; SOME } { NONE (pair string nat) } ;
                                        IF_NONE { PUSH string "no head" ; FAILWITH } {} ;
                                        SWAP ;
                                        IF_CONS { DROP ; SOME } { NONE (list (pair string nat)) } ;
                                        IF_NONE { PUSH string "no tail" ; FAILWITH } {} ;
                                        EMPTY_MAP string bytes ;
                                        DUP 3 ;
                                        CAR ;
                                        PACK ;
                                        SOME ;
                                        PUSH string "" ;
                                        UPDATE ;
                                        DIG 4 ;
                                        DIG 3 ;
                                        CDR ;
                                        SOME ;
                                        DUP 6 ;
                                        SENDER ;
                                        PAIR ;
                                        PAIR 3 ;
                                        PUSH nat 1 ;
                                        DUP 6 ;
                                        ADD ;
                                        DIG 6 ;
                                        SWAP ;
                                        DIG 2 ;
                                        UNPAIR 3 ;
                                        UPDATE ;
                                        DIG 5 ;
                                        DIG 4 ;
                                        DUP 7 ;
                                        PAIR ;
                                        SOME ;
                                        DIG 6 ;
                                        UPDATE ;
                                        DIG 4 ;
                                        PAIR 5 ;
                                        LEFT (pair (big_map nat (pair nat (map string bytes))) (big_map (pair address nat) nat)) } } } ;
                          UNPAIR ;
                          SELF_ADDRESS ;
                          DUP 6 ;
                          GET 6 ;
                          PUSH bool False ;
                          EMPTY_SET address ;
                          DIG 4 ;
                          EMPTY_BIG_MAP string bytes ;
                          EMPTY_BIG_MAP (pair address address nat) unit ;
                          DIG 7 ;
                          PAIR 8 ;
                          PUSH mutez 0 ;
                          NONE key_hash ;
                          PAIR ;
                          PAIR ;
                          UNPPAIIR ;
                          CREATE_CONTRACT
                            { parameter
                                (or (or (or (or (pair %balance_of
                                                   (list %requests (pair (address %owner) (nat %token_id)))
                                                   (contract %callback
                                                      (list (pair (pair %request (address %owner) (nat %token_id)) (nat %balance)))))
                                                (pair %mint
                                                   (nat %token_id)
                                                   (map %token_metadata string bytes)
                                                   (nat %amount_)
                                                   (address %owner)))
                                            (or (bool %setPause)
                                                (list %transfer
                                                   (pair (address %from_) (list %txs (pair (address %to_) (nat %token_id) (nat %amount)))))))
                                        (or (or (bytes %updateContractMetadata) (address %updateMultisig))
                                            (or (or %updateProxy (address %add_proxy) (address %remove_proxy))
                                                (pair %updateTokenMetadata (nat %token_id) (map %token_info string bytes)))))
                                    (list %update_operators
                                       (or (pair %add_operator (address %owner) (address %operator) (nat %token_id))
                                           (pair %remove_operator (address %owner) (address %operator) (nat %token_id))))) ;
                              storage
                                (pair (big_map %ledger (pair address nat) nat)
                                      (big_map %operators (pair address address nat) unit)
                                      (big_map %metadata string bytes)
                                      (big_map %token_metadata nat (pair (nat %token_id) (map %token_info string bytes)))
                                      (set %proxy address)
                                      (bool %paused)
                                      (address %multisig)
                                      (address %manager)) ;
                              code { PUSH string "FA2_TOKEN_UNDEFINED" ;
                                     SWAP ;
                                     UNPAIR ;
                                     IF_LEFT
                                       { IF_LEFT
                                           { IF_LEFT
                                               { IF_LEFT
                                                   { DUP ;
                                                     CAR ;
                                                     MAP { DUP 3 ;
                                                           GET 7 ;
                                                           DUP 2 ;
                                                           CDR ;
                                                           GET ;
                                                           IF_NONE { DUP 4 ; FAILWITH } { DROP } ;
                                                           DUP 3 ;
                                                           CAR ;
                                                           DUP 2 ;
                                                           CDR ;
                                                           DUP 3 ;
                                                           CAR ;
                                                           PAIR ;
                                                           GET ;
                                                           IF_NONE { PUSH nat 0 } {} ;
                                                           SWAP ;
                                                           PAIR } ;
                                                     DIG 3 ;
                                                     DROP ;
                                                     SWAP ;
                                                     CDR ;
                                                     PUSH mutez 0 ;
                                                     DIG 2 ;
                                                     TRANSFER_TOKENS ;
                                                     SWAP ;
                                                     NIL operation ;
                                                     DIG 2 ;
                                                     CONS }
                                                   { DIG 2 ;
                                                     DROP ;
                                                     DUP 2 ;
                                                     GET 11 ;
                                                     IF { DROP 2 ; PUSH nat 8 ; FAILWITH }
                                                        { PUSH bool False ;
                                                          DUP 3 ;
                                                          GET 9 ;
                                                          SENDER ;
                                                          MEM ;
                                                          COMPARE ;
                                                          EQ ;
                                                          IF { DROP 2 ; PUSH nat 2 ; FAILWITH }
                                                             { UNPAIR 4 ;
                                                               DUP 5 ;
                                                               CAR ;
                                                               DUP 2 ;
                                                               DUP 6 ;
                                                               PAIR ;
                                                               GET ;
                                                               IF_NONE {} { DROP ; PUSH string "token already exists" ; FAILWITH } ;
                                                               DUP 2 ;
                                                               PUSH string "" ;
                                                               GET ;
                                                               IF_NONE { PUSH string "option is None" ; FAILWITH } {} ;
                                                               DUP ;
                                                               SIZE ;
                                                               SWAP ;
                                                               PUSH nat 6 ;
                                                               DIG 2 ;
                                                               SUB ;
                                                               ABS ;
                                                               PUSH nat 6 ;
                                                               PAIR 3 ;
                                                               UNPAIR 3 ;
                                                               SLICE ;
                                                               IF_NONE { PUSH string "SLICE" ; FAILWITH } {} ;
                                                               DUP 6 ;
                                                               DUP 7 ;
                                                               CAR ;
                                                               DIG 5 ;
                                                               SOME ;
                                                               DUP 5 ;
                                                               DIG 7 ;
                                                               PAIR ;
                                                               UPDATE ;
                                                               UPDATE 1 ;
                                                               DIG 4 ;
                                                               GET 7 ;
                                                               DIG 4 ;
                                                               DIG 3 ;
                                                               SOME ;
                                                               PUSH string "" ;
                                                               UPDATE ;
                                                               DUP 4 ;
                                                               PAIR ;
                                                               SOME ;
                                                               DIG 3 ;
                                                               UPDATE ;
                                                               UPDATE 7 } } ;
                                                     NIL operation } ;
                                                 PAIR }
                                               { IF_LEFT
                                                   { DIG 2 ;
                                                     DROP ;
                                                     SELF_ADDRESS ;
                                                     DUP 3 ;
                                                     GET 13 ;
                                                     SENDER ;
                                                     COMPARE ;
                                                     NEQ ;
                                                     IF { DUP 3 ;
                                                          DIG 3 ;
                                                          GET 13 ;
                                                          CONTRACT %callMultisig
                                                            (pair (pair %entrypoint_signature
                                                                     (pair (string %name) (bytes %params))
                                                                     (address %source_contract))
                                                                  (lambda %callback unit (list operation))) ;
                                                          IF_NONE
                                                            { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                                            { DUP 4 ;
                                                              PACK ;
                                                              SHA256 ;
                                                              SELF_ADDRESS ;
                                                              SWAP ;
                                                              PUSH string "setPause" ;
                                                              PAIR ;
                                                              PAIR ;
                                                              SWAP ;
                                                              PUSH mutez 0 ;
                                                              LAMBDA
                                                                (pair (pair address bool) unit)
                                                                (list operation)
                                                                { UNPAIR ;
                                                                  UNPAIR ;
                                                                  DIG 2 ;
                                                                  DROP ;
                                                                  CONTRACT %setPause bool ;
                                                                  IF_NONE
                                                                    { DROP ; PUSH string "no setPause entrypoint" ; FAILWITH }
                                                                    { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                                              DUP 7 ;
                                                              DUP 7 ;
                                                              PAIR ;
                                                              APPLY ;
                                                              DIG 5 ;
                                                              DIG 6 ;
                                                              DROP 2 ;
                                                              DIG 3 ;
                                                              PAIR ;
                                                              TRANSFER_TOKENS ;
                                                              NIL operation ;
                                                              SWAP ;
                                                              CONS } }
                                                        { DROP ; UPDATE 11 ; NIL operation } ;
                                                     PAIR }
                                                   { DUP 2 ;
                                                     GET 11 ;
                                                     IF { DROP 3 ; PUSH nat 8 ; FAILWITH }
                                                        { DUP 2 ;
                                                          CAR ;
                                                          SWAP ;
                                                          ITER { SWAP ;
                                                                 DUP 2 ;
                                                                 CDR ;
                                                                 ITER { SWAP ;
                                                                        DUP ;
                                                                        DUP 3 ;
                                                                        GET 3 ;
                                                                        DUP 5 ;
                                                                        CAR ;
                                                                        PAIR ;
                                                                        GET ;
                                                                        IF_NONE
                                                                          { DROP 2 ; DUP 3 ; FAILWITH }
                                                                          { DUP 3 ;
                                                                            GET 4 ;
                                                                            DUP 2 ;
                                                                            COMPARE ;
                                                                            LT ;
                                                                            IF { DROP 3 ; PUSH string "FA2_INSUFFICIENT_BALANCE" ; FAILWITH }
                                                                               { DUP 2 ;
                                                                                 DUP 4 ;
                                                                                 GET 3 ;
                                                                                 DUP 5 ;
                                                                                 CAR ;
                                                                                 PAIR ;
                                                                                 GET ;
                                                                                 IF_NONE { DUP 3 ; GET 4 } { DUP 4 ; GET 4 ; ADD } ;
                                                                                 DUP 4 ;
                                                                                 GET 4 ;
                                                                                 DIG 2 ;
                                                                                 SUB ;
                                                                                 ABS ;
                                                                                 DUP 6 ;
                                                                                 GET 3 ;
                                                                                 DUP 5 ;
                                                                                 GET 3 ;
                                                                                 PAIR ;
                                                                                 SENDER ;
                                                                                 DUP 7 ;
                                                                                 CAR ;
                                                                                 DIG 2 ;
                                                                                 UNPAIR ;
                                                                                 DUP 4 ;
                                                                                 DUP 4 ;
                                                                                 COMPARE ;
                                                                                 EQ ;
                                                                                 IF { DROP 4 }
                                                                                    { DIG 3 ;
                                                                                      PAIR ;
                                                                                      DIG 2 ;
                                                                                      PAIR ;
                                                                                      MEM ;
                                                                                      IF {} { PUSH string "FA2_NOT_OPERATOR" ; FAILWITH } } ;
                                                                                 PUSH nat 0 ;
                                                                                 DUP 5 ;
                                                                                 GET 4 ;
                                                                                 COMPARE ;
                                                                                 EQ ;
                                                                                 IF { SWAP ; DIG 3 ; DROP 3 }
                                                                                    { DUG 2 ;
                                                                                      SOME ;
                                                                                      DUP 4 ;
                                                                                      GET 3 ;
                                                                                      DUP 5 ;
                                                                                      CAR ;
                                                                                      PAIR ;
                                                                                      UPDATE ;
                                                                                      SWAP ;
                                                                                      SOME ;
                                                                                      DIG 2 ;
                                                                                      GET 3 ;
                                                                                      DUP 4 ;
                                                                                      CAR ;
                                                                                      PAIR ;
                                                                                      UPDATE } } } } ;
                                                                 SWAP ;
                                                                 DROP } ;
                                                          DIG 2 ;
                                                          DROP ;
                                                          UPDATE 1 ;
                                                          NIL operation ;
                                                          PAIR } } } }
                                           { DIG 2 ;
                                             DROP ;
                                             IF_LEFT
                                               { IF_LEFT
                                                   { DUP 2 ;
                                                     GET 11 ;
                                                     IF { DROP 2 ; PUSH nat 8 ; FAILWITH }
                                                        { DUP 2 ;
                                                          GET 9 ;
                                                          SENDER ;
                                                          MEM ;
                                                          NOT ;
                                                          IF { DROP 2 ; PUSH nat 2 ; FAILWITH }
                                                             { DUP 2 ;
                                                               DIG 2 ;
                                                               GET 5 ;
                                                               DIG 2 ;
                                                               SOME ;
                                                               PUSH string "" ;
                                                               UPDATE ;
                                                               UPDATE 5 ;
                                                               NIL operation ;
                                                               PAIR } } }
                                                   { DUP 2 ;
                                                     GET 13 ;
                                                     SENDER ;
                                                     COMPARE ;
                                                     EQ ;
                                                     IF { UPDATE 13 ; NIL operation }
                                                        { SELF_ADDRESS ;
                                                          DUP 3 ;
                                                          DIG 3 ;
                                                          GET 13 ;
                                                          CONTRACT %callMultisig
                                                            (pair (pair %entrypoint_signature
                                                                     (pair (string %name) (bytes %params))
                                                                     (address %source_contract))
                                                                  (lambda %callback unit (list operation))) ;
                                                          IF_NONE
                                                            { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                                                            { DUP 4 ;
                                                              PACK ;
                                                              SHA256 ;
                                                              SELF_ADDRESS ;
                                                              SWAP ;
                                                              PUSH string "update_multisig" ;
                                                              PAIR ;
                                                              PAIR ;
                                                              SWAP ;
                                                              PUSH mutez 0 ;
                                                              LAMBDA
                                                                (pair (pair address address) unit)
                                                                (list operation)
                                                                { UNPAIR ;
                                                                  UNPAIR ;
                                                                  DIG 2 ;
                                                                  DROP ;
                                                                  CONTRACT %updateMultisig address ;
                                                                  IF_NONE
                                                                    { DROP ; PUSH string "no updateMultisig entrypoint" ; FAILWITH }
                                                                    { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                                                              DUP 7 ;
                                                              DUP 7 ;
                                                              PAIR ;
                                                              APPLY ;
                                                              DIG 5 ;
                                                              DIG 6 ;
                                                              DROP 2 ;
                                                              DIG 3 ;
                                                              PAIR ;
                                                              TRANSFER_TOKENS ;
                                                              NIL operation ;
                                                              SWAP ;
                                                              CONS } } ;
                                                     PAIR } }
                                               { IF_LEFT
                                                   { DUP 2 ;
                                                     GET 14 ;
                                                     SENDER ;
                                                     COMPARE ;
                                                     NEQ ;
                                                     IF { DROP 2 ; PUSH nat 9 ; FAILWITH }
                                                        { IF_LEFT
                                                            { DUP 2 ;
                                                              GET 9 ;
                                                              DUP 2 ;
                                                              MEM ;
                                                              IF { DROP 2 ; PUSH nat 6 ; FAILWITH }
                                                                 { DUP 2 ;
                                                                   DIG 2 ;
                                                                   GET 9 ;
                                                                   DIG 2 ;
                                                                   PUSH bool True ;
                                                                   SWAP ;
                                                                   UPDATE ;
                                                                   UPDATE 9 ;
                                                                   NIL operation ;
                                                                   PAIR } }
                                                            { PUSH bool False ;
                                                              DUP 3 ;
                                                              GET 9 ;
                                                              DUP 3 ;
                                                              MEM ;
                                                              COMPARE ;
                                                              EQ ;
                                                              IF { DROP 2 ; PUSH nat 7 ; FAILWITH }
                                                                 { DUP 2 ;
                                                                   DIG 2 ;
                                                                   GET 9 ;
                                                                   DIG 2 ;
                                                                   PUSH bool False ;
                                                                   SWAP ;
                                                                   UPDATE ;
                                                                   UPDATE 9 ;
                                                                   NIL operation ;
                                                                   PAIR } } } }
                                                   { DUP 2 ;
                                                     GET 11 ;
                                                     IF { DROP 2 ; PUSH nat 8 ; FAILWITH }
                                                        { DUP 2 ;
                                                          GET 9 ;
                                                          SENDER ;
                                                          MEM ;
                                                          NOT ;
                                                          IF { DROP 2 ; PUSH nat 2 ; FAILWITH }
                                                             { UNPAIR ;
                                                               DUP 3 ;
                                                               DIG 3 ;
                                                               GET 7 ;
                                                               DIG 3 ;
                                                               DUP 4 ;
                                                               PAIR ;
                                                               SOME ;
                                                               DIG 3 ;
                                                               UPDATE ;
                                                               UPDATE 7 ;
                                                               NIL operation ;
                                                               PAIR } } } } } }
                                       { DIG 2 ;
                                         DROP ;
                                         SENDER ;
                                         DUP 3 ;
                                         GET 3 ;
                                         DIG 2 ;
                                         ITER { SWAP ;
                                                DUP 3 ;
                                                DUP 3 ;
                                                IF_LEFT {} {} ;
                                                CAR ;
                                                COMPARE ;
                                                EQ ;
                                                IF {} { PUSH string "FA2_NOT_OWNER" ; FAILWITH } ;
                                                SWAP ;
                                                IF_LEFT
                                                  { SWAP ;
                                                    UNIT ;
                                                    SOME ;
                                                    DUP 3 ;
                                                    GET 4 ;
                                                    DUP 4 ;
                                                    GET 3 ;
                                                    PAIR ;
                                                    DIG 3 ;
                                                    CAR ;
                                                    PAIR ;
                                                    UPDATE }
                                                  { SWAP ;
                                                    DUP 2 ;
                                                    GET 4 ;
                                                    DUP 3 ;
                                                    GET 3 ;
                                                    PAIR ;
                                                    DIG 2 ;
                                                    CAR ;
                                                    PAIR ;
                                                    NONE unit ;
                                                    SWAP ;
                                                    UPDATE } } ;
                                         SWAP ;
                                         DROP ;
                                         UPDATE 3 ;
                                         NIL operation ;
                                         PAIR } } } ;
                          DUP 5 ;
                          CAR ;
                          DUP 6 ;
                          GET 3 ;
                          CONTRACT %configCollectionRoyalties
                            (pair (address %nft_address) (nat %first_id) (nat %last_id) (nat %royalties)) ;
                          IF_NONE { PUSH nat 901 ; FAILWITH } {} ;
                          PUSH mutez 0 ;
                          DIG 6 ;
                          DIG 6 ;
                          PUSH nat 0 ;
                          DUP 8 ;
                          PAIR 4 ;
                          TRANSFER_TOKENS ;
                          PUSH nat 0 ;
                          UNIT ;
                          RIGHT (or address (pair address nat)) ;
                          EMPTY_MAP string bytes ;
                          PUSH bool False ;
                          NIL string ;
                          DUP 9 ;
                          PUSH nat 0 ;
                          NOW ;
                          NOW ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          PUSH bool False ;
                          PUSH nat 0 ;
                          EMPTY_BIG_MAP address nat ;
                          PUSH nat 0 ;
                          EMPTY_BIG_MAP address nat ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          PUSH nat 0 ;
                          DUP 24 ;
                          GET 6 ;
                          PAIR 20 ;
                          DIG 6 ;
                          SWAP ;
                          EXEC ;
                          UNPAIR ;
                          SELF_ADDRESS ;
                          CONTRACT %internalUpdateNftProxy
                            (pair (or %update_proxy_param (address %add_proxy) (address %remove_proxy))
                                  (address %nft_address)) ;
                          IF_NONE { PUSH string "option is None" ; FAILWITH } {} ;
                          PUSH mutez 0 ;
                          DUP 8 ;
                          DUP 5 ;
                          LEFT address ;
                          PAIR ;
                          TRANSFER_TOKENS ;
                          DUP 8 ;
                          DIG 8 ;
                          GET 5 ;
                          DIG 4 ;
                          DIG 8 ;
                          PAIR ;
                          SOME ;
                          DUP 7 ;
                          UPDATE ;
                          UPDATE 5 ;
                          PUSH nat 1 ;
                          DIG 5 ;
                          ADD ;
                          UPDATE 1 ;
                          NIL operation ;
                          DIG 4 ;
                          CONS ;
                          DIG 2 ;
                          CONS } ;
                      DIG 2 ;
                      CONS ;
                      DIG 2 ;
                      CONS } ;
                 PAIR }
               { DIG 2 ;
                 DROP ;
                 SELF_ADDRESS ;
                 SENDER ;
                 COMPARE ;
                 NEQ ;
                 IF { DROP 2 ; PUSH nat 902 ; FAILWITH }
                    { SWAP ;
                      NIL operation ;
                      DUP 3 ;
                      CDR ;
                      CONTRACT %updateProxy (or (address %add_proxy) (address %remove_proxy)) ;
                      IF_NONE { PUSH string "option is None" ; FAILWITH } {} ;
                      PUSH mutez 0 ;
                      DIG 4 ;
                      CAR ;
                      PAIR 3 ;
                      UNPAIR 3 ;
                      TRANSFER_TOKENS ;
                      CONS ;
                      PAIR } } }
           { DIG 2 ;
             DROP ;
             DUP 2 ;
             GET 6 ;
             SENDER ;
             COMPARE ;
             NEQ ;
             IF { SELF_ADDRESS ;
                  DUP 3 ;
                  DIG 3 ;
                  GET 6 ;
                  CONTRACT %callMultisig
                    (pair (pair %entrypoint_signature
                             (pair (string %name) (bytes %params))
                             (address %source_contract))
                          (lambda %callback unit (list operation))) ;
                  IF_NONE
                    { SWAP ; DIG 2 ; DROP 2 ; PUSH string "no call entrypoint" ; FAILWITH }
                    { DUP 4 ;
                      PACK ;
                      SHA256 ;
                      SELF_ADDRESS ;
                      SWAP ;
                      PUSH string "updateMultisig" ;
                      PAIR ;
                      PAIR ;
                      SWAP ;
                      PUSH mutez 0 ;
                      LAMBDA
                        (pair (pair address address) unit)
                        (list operation)
                        { UNPAIR ;
                          UNPAIR ;
                          DIG 2 ;
                          DROP ;
                          CONTRACT %updateMultisig address ;
                          IF_NONE
                            { DROP ; PUSH string "no updateMultisig entrypoint" ; FAILWITH }
                            { NIL operation ; SWAP ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } } ;
                      DUP 7 ;
                      DUP 7 ;
                      PAIR ;
                      APPLY ;
                      DIG 5 ;
                      DIG 6 ;
                      DROP 2 ;
                      DIG 3 ;
                      PAIR ;
                      TRANSFER_TOKENS ;
                      NIL operation ;
                      SWAP ;
                      CONS } }
                { UPDATE 6 ; NIL operation } ;
             PAIR } } }

